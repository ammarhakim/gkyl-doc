
<style>/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style>/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{--shift:-40px;text-align:right;margin-top:var(--shift);margin-bottom:calc(0px - var(--shift));clear:both;filter:opacity(1);}.pdoc details:not([open]){height:0;overflow:visible;}.pdoc details > summary{font-size:.75rem;cursor:pointer;color:var(--muted);border-width:0;padding:0 .7em;display:inline-block;display:inline list-item;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc details > div{margin-top:calc(0px - var(--shift) / 2);text-align:left;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:3rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:1rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}</style>    <main class="pdoc">
            <section>
                    <h1 class="modulename">
<a href="./../../postgkyl.html">postgkyl</a><wbr>.<a href="./../data.html">data</a><wbr>.data    </h1>

                
                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">postgkyl.utils</span> <span class="kn">import</span> <span class="n">idxParser</span>


<span class="k">class</span> <span class="nc">Data</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Provides interface to Gkeyll output data.</span>

<span class="sd">  Data serves as a baseline interface to Gkeyll data. It is used for</span>
<span class="sd">  loading Gkeyll data and serves is input to many Postgkyl</span>
<span class="sd">  functions. Represents a dataset in the Postgkyl command line mode.</span>

<span class="sd">  Attributes:</span>
<span class="sd">    meta: A dictionary contaioning a physics information like charge</span>
<span class="sd">      and/or representation information like polynomial order.</span>
<span class="sd">    file_name: The name of the Gkeyll file used during initialization.</span>

<span class="sd">  Examples:</span>
<span class="sd">    import postgkyl</span>
<span class="sd">    data = postgkyl.Data(&#39;file.bp&#39;, comp=1)</span>

<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">comp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z0</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z1</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z2</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z3</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z4</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z5</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;CartGridField&#39;</span><span class="p">,</span>
               <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
               <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">comp_grid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">mapc2p_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initializes the Data class with a Gkeyll output file.</span>

<span class="sd">    Args:</span>
<span class="sd">      fileName: str</span>
<span class="sd">        The name of Gkeyll output file. Currently supported are &#39;h5&#39;,</span>
<span class="sd">        ADIOS1 &#39;bp&#39;, and binary &#39;gkyl&#39; files. Can be ommited for empty</span>
<span class="sd">        class.</span>
<span class="sd">      comp: int or &#39;int:int&#39;</span>
<span class="sd">        Load only the specified component index or a slice of</span>
<span class="sd">        idices. Supported only for the ADIOS &#39;bp&#39; files.</span>
<span class="sd">      z0 - z5: int or &#39;int:int&#39;</span>
<span class="sd">        Load only the specified  index or a slice of</span>
<span class="sd">        idices in a direction. Supported only for the ADIOS &#39;bp&#39; files.</span>
<span class="sd">      var_name: str</span>
<span class="sd">        Specify custom ADIOS variable name (default is &#39;CartGridField&#39;).</span>
<span class="sd">      tag: str</span>
<span class="sd">        Specify dataset tag for use in the command line mode.</span>
<span class="sd">      label: str</span>
<span class="sd">        Specify dataset label for use in the command line mode.</span>
<span class="sd">      meta: dict</span>
<span class="sd">        Copy content of the specified meta dictionary.</span>
<span class="sd">      comp_grid: bool</span>
<span class="sd">        A flag to ignore grid mapping.</span>
<span class="sd">      mapc2p_name: str</span>
<span class="sd">        The name of the file containg the c2p mapping information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span> <span class="o">=</span> <span class="n">tag</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_comp_grid</span> <span class="o">=</span> <span class="n">comp_grid</span> <span class="c1"># disregard the mapped grid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">=</span> <span class="s1">&#39;uniform&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_gridFile</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># (N+1)D narray of values</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">meta</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span> <span class="o">=</span> <span class="n">label</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span> <span class="o">=</span> <span class="n">var_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span> <span class="o">=</span> <span class="n">mapc2p_name</span>
    <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="c1"># Sequence load typically concatenates multiple files</span>
      <span class="c1"># When the sequence is in just a single file, _loadFrame will</span>
      <span class="c1"># fail and _loadSequence is called instead</span>
      <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">):</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">z3</span><span class="p">,</span> <span class="n">z4</span><span class="p">,</span> <span class="n">z5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadFrame</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadSequence</span><span class="p">()</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#end</span>

  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- File Loading -------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">_createOffsetCountBp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bpVar</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="n">comp</span><span class="p">):</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bpVar</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bpVar</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zs</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Last dim stores comp</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">idxParser</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
          <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
          <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
          <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">start</span>
          <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">z</span><span class="o">.</span><span class="n">start</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">z</span><span class="se">\&#39;</span><span class="s1"> is neither number or slice&#39;</span><span class="p">)</span>
        <span class="c1">#end</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="k">if</span> <span class="n">comp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">comp</span> <span class="o">=</span> <span class="n">idxParser</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">offset</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span>
        <span class="n">count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
        <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">start</span>
        <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">comp</span><span class="o">.</span><span class="n">start</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">comp</span><span class="se">\&#39;</span><span class="s1"> is neither number or slice&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1">#end</span>

    <span class="k">if</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">offset</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">(),</span> <span class="p">()</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">_load_gkyl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">dti8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>
    <span class="n">dtf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;f8&#39;</span><span class="p">)</span>
    <span class="n">doffset</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># read real-type</span>
    <span class="n">realType</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">realType</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">dtf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>
      <span class="n">doffset</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="c1">#end</span>

    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>
            
    <span class="c1"># read grid dimensions</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>

    <span class="c1"># read grid shape</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">num_dims</span><span class="o">*</span><span class="mi">8</span>

    <span class="c1"># read lower/upper</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtf</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">num_dims</span><span class="o">*</span><span class="n">doffset</span>

    <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtf</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">num_dims</span><span class="o">*</span><span class="n">doffset</span>

    <span class="c1"># read array elemEz (the div by doffset is as elemSz includes</span>
    <span class="c1"># sizeof(real_type) = doffset)</span>
    <span class="n">elemSzRaw</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
      <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">elemSz</span> <span class="o">=</span> <span class="n">elemSzRaw</span><span class="o">/</span><span class="n">doffset</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>

    <span class="c1"># read array size</span>
    <span class="n">asize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>

    <span class="n">adata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtf</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">gshape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_dims</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;i8&#39;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
      <span class="n">gshape</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
    <span class="c1">#end</span>
    <span class="n">numComp</span> <span class="o">=</span> <span class="n">elemSz</span>
    <span class="n">gshape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numComp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">num_dims</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">adata</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">gshape</span><span class="p">)</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">_loadFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                 <span class="n">comp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_file_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;h5&#39;</span><span class="p">:</span>
      <span class="kn">import</span> <span class="nn">tables</span>
      <span class="n">fh</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;/StructGridField&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadSequence</span><span class="p">()</span>
        <span class="k">return</span>
      <span class="c1">#end</span>
            
      <span class="c1"># Get the atributes</span>
      <span class="n">lower</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGrid</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsLowerBounds</span>
      <span class="n">upper</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGrid</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsUpperBounds</span>
      <span class="n">cells</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGrid</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsNumCells</span>
      <span class="c1"># Load data ...</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGridField</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="c1"># ... and the time-stamp</span>
      <span class="k">if</span> <span class="s1">&#39;/timeData&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">timeData</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsTime</span>
      <span class="c1">#end</span>
      <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span>
      <span class="kn">import</span> <span class="nn">adios</span>
      <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="c1"># Not a Gkyl &#39;frame&#39; data; trying to load as a sequence</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadSequence</span><span class="p">()</span>  
        <span class="k">return</span>
      <span class="c1">#end</span>
      <span class="c1"># Get the atributes</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">attrsList</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
      <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrsList</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="c1">#end</span>
      <span class="c1"># Postgkyl conventions require the attributes to be</span>
      <span class="c1"># narrays even for 1D data</span>
      <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;lowerBounds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
      <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;upperBounds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
      <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;numCells&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
      <span class="k">if</span> <span class="s1">&#39;changeset&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;changeset&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;builddate&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;builddate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;polyOrder&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;polyOrder&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;basisType&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;basisType&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;charge&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;charge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;charge&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;mass&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;frame&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;frame&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="c1">#end</span>

      <span class="c1"># Check for mapped grid ...</span>
      <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comp_grid</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="c1"># .. load nodal grid if provided ...</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;uniform&#39;</span><span class="p">:</span>
        <span class="k">pass</span> <span class="c1"># nothing to do for uniform grids</span>
      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;grid&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
          <span class="n">gridNm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_dir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;grid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">gridNm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_dir</span> <span class="o">+</span> <span class="s1">&#39;/grid&#39;</span>  
        <span class="c1">#end</span>
        <span class="k">with</span> <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">gridNm</span><span class="p">)</span> <span class="k">as</span> <span class="n">gridFh</span><span class="p">:</span>
          <span class="n">gridVar</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">gridFh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">)</span>
          <span class="n">offset</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createOffsetCountBp</span><span class="p">(</span><span class="n">gridVar</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="n">tmp</span> <span class="o">=</span> <span class="n">gridVar</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
          <span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                  <span class="c1">#for d in range(len(cells))]</span>
                  <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
        <span class="c1">#end</span>
      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;nonuniform&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">nonuniform</span><span class="se">\&#39;</span><span class="s1"> is not presently supported&#39;</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unsupported grid type info in field!&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>

      <span class="c1"># Load data</span>
      <span class="n">var</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">)</span>
      <span class="n">offset</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createOffsetCountBp</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>

      <span class="c1"># Adjust boundaries for &#39;offset&#39; and &#39;count&#39;</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
      <span class="n">dz</span> <span class="o">=</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)</span> <span class="o">/</span> <span class="n">cells</span>
      <span class="k">if</span> <span class="n">offset</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;uniform&#39;</span><span class="p">:</span>
          <span class="n">lower</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">offset</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span><span class="o">*</span><span class="n">dz</span>
          <span class="n">cells</span> <span class="o">=</span> <span class="n">cells</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
          <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
            <span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx</span><span class="p">)]</span>
            <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
          <span class="c1">#end</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="n">count</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;uniform&#39;</span><span class="p">:</span>
          <span class="n">upper</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">count</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span><span class="o">*</span><span class="n">dz</span>
          <span class="n">cells</span> <span class="o">=</span> <span class="n">count</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
          <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
            <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>  <span class="c1">#.Reverse indexing of idx because of transpose() in composing self._grid.</span>
            <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx</span><span class="p">)]</span>
            <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
          <span class="c1">#end</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;gkyl&#39;</span><span class="p">:</span>
      <span class="n">num_dims</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_gkyl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
        <span class="s1">&#39;File extension </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> is not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">extension</span><span class="p">))</span>
    <span class="c1">#end</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">=</span> <span class="s1">&#39;c2p&#39;</span>
      <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;gkyl&#39;</span><span class="p">:</span>
        <span class="n">num_dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_gkyl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span><span class="p">)</span>
        <span class="n">num_comps</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">num_coeff</span> <span class="o">=</span> <span class="n">num_comps</span><span class="o">/</span><span class="n">num_dims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">num_coeff</span><span class="p">):</span><span class="nb">int</span><span class="p">((</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">num_coeff</span><span class="p">)]</span>
                      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
          <span class="s1">&#39;File extension </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> is not supported for mapc2p&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">extension</span><span class="p">))</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)</span> <span class="o">/</span> <span class="n">cells</span>
    <span class="c1"># Adjusts bounds in case ghost layer is included in data</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;Data appears to include ghost cells which is not compatible with mapped grid.&#39;</span> \
            <span class="s1">&#39;Use computational grid </span><span class="se">\&#39;</span><span class="s1">comp_grid</span><span class="se">\&#39;</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
        <span class="c1">#end</span>
        <span class="n">ngl</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">])</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="n">ngu</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">])</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">ngl</span><span class="o">*</span><span class="n">dz</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+</span> <span class="n">ngu</span><span class="o">*</span><span class="n">dz</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="c1"># Construct grids if not loaded already</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)]</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">_loadSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Sequence load typically cancatenates multiple files</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">*&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
        <span class="s1">&#39;File(s) </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> not found or empty.&#39;</span><span class="o">.</span>
        <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>

    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Counter for the number of loaded files</span>
    <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
      <span class="n">extension</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;h5&#39;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">tables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileType</span> <span class="o">=</span> <span class="s1">&#39;hdf5&#39;</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;/DataStruct/data&#39;</span> <span class="ow">in</span> <span class="n">fh</span> <span class="ow">and</span> \
           <span class="s1">&#39;/DataStruct/timeMesh&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
          <span class="n">grid</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">DataStruct</span><span class="o">.</span><span class="n">timeMesh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
          <span class="n">values</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">DataStruct</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
          <span class="k">continue</span>
        <span class="c1">#end</span>
      <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">adios</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileType</span> <span class="o">=</span> <span class="s1">&#39;adios&#39;</span>
        <span class="n">fh</span> <span class="o">=</span>  <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">timeMeshList</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;TimeMesh&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;Data&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
              <span class="n">values</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">dataList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
              <span class="n">grid</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">timeMeshList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">newvals</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">dataList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
              <span class="c1"># deal with weird behavior after restart where some data</span>
              <span class="c1"># doesn&#39;t have second dimension</span>
              <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">newvals</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">newvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">newvals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
              <span class="c1">#end</span>
              <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">newvals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
              <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">timeMeshList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1">#end</span>
          <span class="c1">#end</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
          <span class="k">continue</span>
        <span class="c1">#end</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">continue</span>
      <span class="c1">#end                    </span>
    
      <span class="k">if</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
      <span class="c1">#end</span>
      <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">#end</span>

    <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># No files loaded</span>
      <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
        <span class="s1">&#39;File(s) </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> not found or empty.&#39;</span><span class="o">.</span>
        <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>
    <span class="c1">#end</span>
    <span class="c1"># Squeeze the time coordinate ...</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">)</span>
    <span class="c1">#end</span>
    <span class="c1"># ... and make it a list following the Postgkyl grid conventions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">]</span>

    <span class="c1"># glob() doesn&#39;t guarantee the right order</span>
    <span class="n">sortIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">sortIdx</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sortIdx</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
  <span class="c1">#end</span>


  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- Stuff Control ------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">getTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">setLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">label</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">getLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">getCustomLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">getStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_status</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getInputFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
    <span class="n">inputFile</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;inputfile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">inputFile</span>
  <span class="c1">#end</span>

    
  <span class="k">def</span> <span class="nf">getNumCells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">cells</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getNumComps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getNumDims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">num_dims</span> <span class="o">=</span> <span class="n">num_dims</span> <span class="o">-</span> <span class="mi">1</span>
          <span class="c1">#end</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">num_dims</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">lo</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">lo</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">up</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">lo</span><span class="p">,</span> <span class="n">up</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getGridType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">setGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">setValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
  <span class="c1">#end                       </span>

  <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
    <span class="k">return</span> <span class="bp">self</span>
  <span class="c1">#end</span>

  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- Info ---------------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prints Data object information.</span>
<span class="sd">    </span>
<span class="sd">    Prints time (only when available), number of components, dimension</span>
<span class="sd">    spans, extremes for a GData object. Only the top of the stack is</span>
<span class="sd">    printed.</span>
<span class="sd">        </span>
<span class="sd">    Args:</span>
<span class="sd">      none</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">      output (str): A list of strings with the informations</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
    <span class="n">numComps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumComps</span><span class="p">()</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">()</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBounds</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Time: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Frame: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Number of components: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numComps</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Number of dimensions: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Grid: (</span><span class="si">{:s}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Dim </span><span class="si">{:d}</span><span class="s1">: Num. cells: </span><span class="si">{:d}</span><span class="s1">; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">numCells</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;Lower: </span><span class="si">{:e}</span><span class="s1">; Upper: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                                      <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Dim </span><span class="si">{:d}</span><span class="s1">: Num. cells: </span><span class="si">{:d}</span><span class="s1">; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">numCells</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;Lower: </span><span class="si">{:e}</span><span class="s1">; Upper: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                                    <span class="n">upper</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">maximum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
      <span class="n">maxIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
      <span class="n">minimum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
      <span class="n">minIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmin</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Maximum: </span><span class="si">{:e}</span><span class="s1"> at </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maximum</span><span class="p">,</span>
                                                  <span class="nb">str</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]))</span>
      <span class="k">if</span> <span class="n">numComps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39; component </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Minimum: </span><span class="si">{:e}</span><span class="s1"> at </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span>
                                                       <span class="nb">str</span><span class="p">(</span><span class="n">minIdx</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]))</span>
      <span class="k">if</span> <span class="n">numComps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39; component </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minIdx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">├─ DG info:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Polynomial Order: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]:</span>
          <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Basis Type: </span><span class="si">{:s}</span><span class="s1"> (modal)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Basis Type: </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">])</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">├─ Created with Gkeyll:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Changeset: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">])</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Build Date: </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>

      <span class="c1">#output += &#39;\n- Contains attributes:\n  &#39;</span>
      <span class="c1">#for k in self.attrsList:</span>
      <span class="c1">#    output += &#39;{:s} &#39;.format(k)</span>
      <span class="c1">#end</span>
            
      <span class="k">return</span> <span class="n">output</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="s1">&#39;No data&#39;</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>


  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- Write --------------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">outName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes data in ADIOS .bp file, ASCII .txt file, or NumPy .npy file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create output file name</span>
    <span class="k">if</span> <span class="n">outName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span>
        <span class="n">outName</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_mod.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">outName</span> <span class="o">=</span> <span class="s1">&#39;gdata.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="c1">#end</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">outName</span><span class="se">\&#39;</span><span class="s1"> must be a string&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mode</span><span class="p">:</span>
        <span class="n">outName</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="n">num_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">()</span>
    <span class="n">numComps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumComps</span><span class="p">()</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span>
      <span class="c1"># Create string number of cells and offsets</span>
      <span class="n">sNumCells</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="n">sOffsets</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">sNumCells</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">,&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numCells</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">sOffsets</span> <span class="o">+=</span> <span class="s1">&#39;0,&#39;</span>
      <span class="c1">#end</span>
      <span class="n">sNumCells</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numComps</span><span class="p">)</span>
      <span class="n">sOffsets</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>

      <span class="c1"># ADIOS init</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">init_noxml</span><span class="p">()</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">set_max_buffer_size</span><span class="p">(</span><span class="n">bufferSize</span><span class="p">)</span>
      <span class="n">groupId</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">declare_group</span><span class="p">(</span><span class="s1">&#39;CartField&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">select_method</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;POSIX1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

      <span class="c1"># Define variables and attributes</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;numCells&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">numCells</span><span class="p">)</span>
      <span class="n">lo</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBounds</span><span class="p">()</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;lowerBounds&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;upperBounds&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">up</span><span class="p">)</span>
      <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;CartField&#39;</span><span class="p">,</span> <span class="n">outName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]:</span>
        <span class="n">adios</span><span class="o">.</span><span class="n">define_var</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                         <span class="n">adios</span><span class="o">.</span><span class="n">DATATYPE</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">adios</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
            
      <span class="n">adios</span><span class="o">.</span><span class="n">define_var</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                       <span class="n">adios</span><span class="o">.</span><span class="n">DATATYPE</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
                       <span class="n">sNumCells</span><span class="p">,</span> <span class="n">sNumCells</span><span class="p">,</span> <span class="n">sOffsets</span><span class="p">)</span>

      <span class="n">adios</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">())</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

      <span class="c1"># Cheating</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nm</span> <span class="o">=</span> <span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">nm</span> <span class="o">=</span> <span class="n">outName</span>
      <span class="c1">#end</span>
      <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">outName</span> <span class="o">+</span> <span class="s1">&#39;.dir/&#39;</span> <span class="o">+</span> <span class="n">nm</span> <span class="o">+</span> <span class="s1">&#39;.0&#39;</span><span class="p">,</span> <span class="n">outName</span><span class="p">)</span>
      <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">outName</span> <span class="o">+</span> <span class="s1">&#39;.dir&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;txt&#39;</span><span class="p">:</span>
      <span class="n">numRows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numCells</span><span class="o">.</span><span class="n">prod</span><span class="p">())</span>
      <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGrid</span><span class="p">()</span>
      <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>

      <span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">numCells</span><span class="p">[(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
      <span class="c1">#end</span>

      <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
          <span class="n">idxs</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span> <span class="o">//</span> <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
          <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="n">idxs</span><span class="p">[</span><span class="n">d</span><span class="p">]])</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">idxs</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numComps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="p">)][</span><span class="n">c</span><span class="p">])</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="p">)][</span><span class="n">numComps</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;npy&#39;</span><span class="p">:</span>
      <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
      <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>
<span class="c1">#end</span>
</pre></div>

        </details>

            </section>
                <section id="Data">
                                <div class="attr class">
        <a class="headerlink" href="#Data">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Data</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Data</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Provides interface to Gkeyll output data.</span>

<span class="sd">  Data serves as a baseline interface to Gkeyll data. It is used for</span>
<span class="sd">  loading Gkeyll data and serves is input to many Postgkyl</span>
<span class="sd">  functions. Represents a dataset in the Postgkyl command line mode.</span>

<span class="sd">  Attributes:</span>
<span class="sd">    meta: A dictionary contaioning a physics information like charge</span>
<span class="sd">      and/or representation information like polynomial order.</span>
<span class="sd">    file_name: The name of the Gkeyll file used during initialization.</span>

<span class="sd">  Examples:</span>
<span class="sd">    import postgkyl</span>
<span class="sd">    data = postgkyl.Data(&#39;file.bp&#39;, comp=1)</span>

<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">comp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z0</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z1</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z2</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z3</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z4</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z5</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;CartGridField&#39;</span><span class="p">,</span>
               <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
               <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">comp_grid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">mapc2p_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initializes the Data class with a Gkeyll output file.</span>

<span class="sd">    Args:</span>
<span class="sd">      fileName: str</span>
<span class="sd">        The name of Gkeyll output file. Currently supported are &#39;h5&#39;,</span>
<span class="sd">        ADIOS1 &#39;bp&#39;, and binary &#39;gkyl&#39; files. Can be ommited for empty</span>
<span class="sd">        class.</span>
<span class="sd">      comp: int or &#39;int:int&#39;</span>
<span class="sd">        Load only the specified component index or a slice of</span>
<span class="sd">        idices. Supported only for the ADIOS &#39;bp&#39; files.</span>
<span class="sd">      z0 - z5: int or &#39;int:int&#39;</span>
<span class="sd">        Load only the specified  index or a slice of</span>
<span class="sd">        idices in a direction. Supported only for the ADIOS &#39;bp&#39; files.</span>
<span class="sd">      var_name: str</span>
<span class="sd">        Specify custom ADIOS variable name (default is &#39;CartGridField&#39;).</span>
<span class="sd">      tag: str</span>
<span class="sd">        Specify dataset tag for use in the command line mode.</span>
<span class="sd">      label: str</span>
<span class="sd">        Specify dataset label for use in the command line mode.</span>
<span class="sd">      meta: dict</span>
<span class="sd">        Copy content of the specified meta dictionary.</span>
<span class="sd">      comp_grid: bool</span>
<span class="sd">        A flag to ignore grid mapping.</span>
<span class="sd">      mapc2p_name: str</span>
<span class="sd">        The name of the file containg the c2p mapping information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span> <span class="o">=</span> <span class="n">tag</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_comp_grid</span> <span class="o">=</span> <span class="n">comp_grid</span> <span class="c1"># disregard the mapped grid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">=</span> <span class="s1">&#39;uniform&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_gridFile</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># (N+1)D narray of values</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">meta</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span> <span class="o">=</span> <span class="n">label</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span> <span class="o">=</span> <span class="n">var_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span> <span class="o">=</span> <span class="n">mapc2p_name</span>
    <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="c1"># Sequence load typically concatenates multiple files</span>
      <span class="c1"># When the sequence is in just a single file, _loadFrame will</span>
      <span class="c1"># fail and _loadSequence is called instead</span>
      <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">):</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">z3</span><span class="p">,</span> <span class="n">z4</span><span class="p">,</span> <span class="n">z5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadFrame</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadSequence</span><span class="p">()</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#end</span>

  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- File Loading -------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">_createOffsetCountBp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bpVar</span><span class="p">,</span> <span class="n">zs</span><span class="p">,</span> <span class="n">comp</span><span class="p">):</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bpVar</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bpVar</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zs</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Last dim stores comp</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">idxParser</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
          <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
          <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
          <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">start</span>
          <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">z</span><span class="o">.</span><span class="n">start</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">z</span><span class="se">\&#39;</span><span class="s1"> is neither number or slice&#39;</span><span class="p">)</span>
        <span class="c1">#end</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="k">if</span> <span class="n">comp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">comp</span> <span class="o">=</span> <span class="n">idxParser</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">offset</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span>
        <span class="n">count</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
        <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">start</span>
        <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">comp</span><span class="o">.</span><span class="n">start</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">comp</span><span class="se">\&#39;</span><span class="s1"> is neither number or slice&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1">#end</span>

    <span class="k">if</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">offset</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">(),</span> <span class="p">()</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">_load_gkyl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">dti8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;i8&#39;</span><span class="p">)</span>
    <span class="n">dtf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;f8&#39;</span><span class="p">)</span>
    <span class="n">doffset</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># read real-type</span>
    <span class="n">realType</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">realType</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">dtf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>
      <span class="n">doffset</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="c1">#end</span>

    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>
            
    <span class="c1"># read grid dimensions</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>

    <span class="c1"># read grid shape</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">num_dims</span><span class="o">*</span><span class="mi">8</span>

    <span class="c1"># read lower/upper</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtf</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">num_dims</span><span class="o">*</span><span class="n">doffset</span>

    <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtf</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="n">num_dims</span><span class="o">*</span><span class="n">doffset</span>

    <span class="c1"># read array elemEz (the div by doffset is as elemSz includes</span>
    <span class="c1"># sizeof(real_type) = doffset)</span>
    <span class="n">elemSzRaw</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
      <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">elemSz</span> <span class="o">=</span> <span class="n">elemSzRaw</span><span class="o">/</span><span class="n">doffset</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>

    <span class="c1"># read array size</span>
    <span class="n">asize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dti8</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">offset</span> <span class="o">+=</span> <span class="mi">8</span>

    <span class="n">adata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtf</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">gshape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_dims</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;i8&#39;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
      <span class="n">gshape</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
    <span class="c1">#end</span>
    <span class="n">numComp</span> <span class="o">=</span> <span class="n">elemSz</span>
    <span class="n">gshape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numComp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">num_dims</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">adata</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">gshape</span><span class="p">)</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">_loadFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                 <span class="n">comp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_file_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;h5&#39;</span><span class="p">:</span>
      <span class="kn">import</span> <span class="nn">tables</span>
      <span class="n">fh</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;/StructGridField&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadSequence</span><span class="p">()</span>
        <span class="k">return</span>
      <span class="c1">#end</span>
            
      <span class="c1"># Get the atributes</span>
      <span class="n">lower</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGrid</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsLowerBounds</span>
      <span class="n">upper</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGrid</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsUpperBounds</span>
      <span class="n">cells</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGrid</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsNumCells</span>
      <span class="c1"># Load data ...</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">StructGridField</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="c1"># ... and the time-stamp</span>
      <span class="k">if</span> <span class="s1">&#39;/timeData&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">timeData</span><span class="o">.</span><span class="n">_v_attrs</span><span class="o">.</span><span class="n">vsTime</span>
      <span class="c1">#end</span>
      <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span>
      <span class="kn">import</span> <span class="nn">adios</span>
      <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="c1"># Not a Gkyl &#39;frame&#39; data; trying to load as a sequence</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadSequence</span><span class="p">()</span>  
        <span class="k">return</span>
      <span class="c1">#end</span>
      <span class="c1"># Get the atributes</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">attrsList</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
      <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrsList</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="c1">#end</span>
      <span class="c1"># Postgkyl conventions require the attributes to be</span>
      <span class="c1"># narrays even for 1D data</span>
      <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;lowerBounds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
      <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;upperBounds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
      <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;numCells&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
      <span class="k">if</span> <span class="s1">&#39;changeset&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;changeset&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;builddate&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;builddate&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;polyOrder&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;polyOrder&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;basisType&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;basisType&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;charge&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;charge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;charge&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;mass&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="s1">&#39;frame&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;frame&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="c1">#end</span>

      <span class="c1"># Check for mapped grid ...</span>
      <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comp_grid</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="c1"># .. load nodal grid if provided ...</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;uniform&#39;</span><span class="p">:</span>
        <span class="k">pass</span> <span class="c1"># nothing to do for uniform grids</span>
      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;grid&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
          <span class="n">gridNm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_dir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span><span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;grid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">gridNm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_dir</span> <span class="o">+</span> <span class="s1">&#39;/grid&#39;</span>  
        <span class="c1">#end</span>
        <span class="k">with</span> <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">gridNm</span><span class="p">)</span> <span class="k">as</span> <span class="n">gridFh</span><span class="p">:</span>
          <span class="n">gridVar</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">gridFh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">)</span>
          <span class="n">offset</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createOffsetCountBp</span><span class="p">(</span><span class="n">gridVar</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
          <span class="n">tmp</span> <span class="o">=</span> <span class="n">gridVar</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>
          <span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                  <span class="c1">#for d in range(len(cells))]</span>
                  <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
        <span class="c1">#end</span>
      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;nonuniform&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">nonuniform</span><span class="se">\&#39;</span><span class="s1"> is not presently supported&#39;</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unsupported grid type info in field!&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>

      <span class="c1"># Load data</span>
      <span class="n">var</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">)</span>
      <span class="n">offset</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createOffsetCountBp</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>

      <span class="c1"># Adjust boundaries for &#39;offset&#39; and &#39;count&#39;</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
      <span class="n">dz</span> <span class="o">=</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)</span> <span class="o">/</span> <span class="n">cells</span>
      <span class="k">if</span> <span class="n">offset</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;uniform&#39;</span><span class="p">:</span>
          <span class="n">lower</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">offset</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span><span class="o">*</span><span class="n">dz</span>
          <span class="n">cells</span> <span class="o">=</span> <span class="n">cells</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
          <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
            <span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx</span><span class="p">)]</span>
            <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
          <span class="c1">#end</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="n">count</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;uniform&#39;</span><span class="p">:</span>
          <span class="n">upper</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">count</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span><span class="o">*</span><span class="n">dz</span>
          <span class="n">cells</span> <span class="o">=</span> <span class="n">count</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
          <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
            <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>  <span class="c1">#.Reverse indexing of idx because of transpose() in composing self._grid.</span>
            <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx</span><span class="p">)]</span>
            <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
          <span class="c1">#end</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;gkyl&#39;</span><span class="p">:</span>
      <span class="n">num_dims</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_gkyl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
        <span class="s1">&#39;File extension </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> is not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">extension</span><span class="p">))</span>
    <span class="c1">#end</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">=</span> <span class="s1">&#39;c2p&#39;</span>
      <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;gkyl&#39;</span><span class="p">:</span>
        <span class="n">num_dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_gkyl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span><span class="p">)</span>
        <span class="n">num_comps</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">num_coeff</span> <span class="o">=</span> <span class="n">num_comps</span><span class="o">/</span><span class="n">num_dims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">num_coeff</span><span class="p">):</span><span class="nb">int</span><span class="p">((</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">num_coeff</span><span class="p">)]</span>
                      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
          <span class="s1">&#39;File extension </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> is not supported for mapc2p&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">extension</span><span class="p">))</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)</span> <span class="o">/</span> <span class="n">cells</span>
    <span class="c1"># Adjusts bounds in case ghost layer is included in data</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">==</span> <span class="s1">&#39;mapped&#39;</span><span class="p">:</span>
          <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;Data appears to include ghost cells which is not compatible with mapped grid.&#39;</span> \
            <span class="s1">&#39;Use computational grid </span><span class="se">\&#39;</span><span class="s1">comp_grid</span><span class="se">\&#39;</span><span class="s1"> instead.&#39;</span><span class="p">)</span>
        <span class="c1">#end</span>
        <span class="n">ngl</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">])</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="n">ngu</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">])</span><span class="o">*</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-</span> <span class="n">ngl</span><span class="o">*</span><span class="n">dz</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+</span> <span class="n">ngu</span><span class="o">*</span><span class="n">dz</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="c1"># Construct grids if not loaded already</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)]</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">_loadSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Sequence load typically cancatenates multiple files</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">*&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
        <span class="s1">&#39;File(s) </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> not found or empty.&#39;</span><span class="o">.</span>
        <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>

    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Counter for the number of loaded files</span>
    <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
      <span class="n">extension</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;h5&#39;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">tables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileType</span> <span class="o">=</span> <span class="s1">&#39;hdf5&#39;</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;/DataStruct/data&#39;</span> <span class="ow">in</span> <span class="n">fh</span> <span class="ow">and</span> \
           <span class="s1">&#39;/DataStruct/timeMesh&#39;</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
          <span class="n">grid</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">DataStruct</span><span class="o">.</span><span class="n">timeMesh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
          <span class="n">values</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">DataStruct</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
          <span class="k">continue</span>
        <span class="c1">#end</span>
      <span class="k">elif</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">adios</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileType</span> <span class="o">=</span> <span class="s1">&#39;adios&#39;</span>
        <span class="n">fh</span> <span class="o">=</span>  <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">timeMeshList</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;TimeMesh&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;Data&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
              <span class="n">values</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">dataList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
              <span class="n">grid</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">timeMeshList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">newvals</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">dataList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
              <span class="c1"># deal with weird behavior after restart where some data</span>
              <span class="c1"># doesn&#39;t have second dimension</span>
              <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">newvals</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">newvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">newvals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
              <span class="c1">#end</span>
              <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">newvals</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
              <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">adios</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">timeMeshList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1">#end</span>
          <span class="c1">#end</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
          <span class="k">continue</span>
        <span class="c1">#end</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">continue</span>
      <span class="c1">#end                    </span>
    
      <span class="k">if</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
      <span class="c1">#end</span>
      <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">#end</span>

    <span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># No files loaded</span>
      <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
        <span class="s1">&#39;File(s) </span><span class="se">\&#39;</span><span class="si">{:s}</span><span class="se">\&#39;</span><span class="s1"> not found or empty.&#39;</span><span class="o">.</span>
        <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">))</span>
    <span class="c1">#end</span>
    <span class="c1"># Squeeze the time coordinate ...</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">)</span>
    <span class="c1">#end</span>
    <span class="c1"># ... and make it a list following the Postgkyl grid conventions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">]</span>

    <span class="c1"># glob() doesn&#39;t guarantee the right order</span>
    <span class="n">sortIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">sortIdx</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">sortIdx</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
  <span class="c1">#end</span>


  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- Stuff Control ------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">getTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">setLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">label</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">getLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">getCustomLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">True</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="c1">#end</span>
  <span class="k">def</span> <span class="nf">getStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_status</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getInputFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
    <span class="n">inputFile</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;inputfile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">inputFile</span>
  <span class="c1">#end</span>

    
  <span class="k">def</span> <span class="nf">getNumCells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">cells</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getNumComps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getNumDims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">num_dims</span> <span class="o">=</span> <span class="n">num_dims</span> <span class="o">-</span> <span class="mi">1</span>
          <span class="c1">#end</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">num_dims</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">lo</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">lo</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">up</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">lo</span><span class="p">,</span> <span class="n">up</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getGridType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">getValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">setGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
  <span class="c1">#end</span>

  <span class="k">def</span> <span class="nf">setValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
  <span class="c1">#end                       </span>

  <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
    <span class="k">return</span> <span class="bp">self</span>
  <span class="c1">#end</span>

  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- Info ---------------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prints Data object information.</span>
<span class="sd">    </span>
<span class="sd">    Prints time (only when available), number of components, dimension</span>
<span class="sd">    spans, extremes for a GData object. Only the top of the stack is</span>
<span class="sd">    printed.</span>
<span class="sd">        </span>
<span class="sd">    Args:</span>
<span class="sd">      none</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">      output (str): A list of strings with the informations</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
    <span class="n">numComps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumComps</span><span class="p">()</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">()</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBounds</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Time: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Frame: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Number of components: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numComps</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Number of dimensions: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Grid: (</span><span class="si">{:s}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Dim </span><span class="si">{:d}</span><span class="s1">: Num. cells: </span><span class="si">{:d}</span><span class="s1">; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">numCells</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;Lower: </span><span class="si">{:e}</span><span class="s1">; Upper: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                                      <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Dim </span><span class="si">{:d}</span><span class="s1">: Num. cells: </span><span class="si">{:d}</span><span class="s1">; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">numCells</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;Lower: </span><span class="si">{:e}</span><span class="s1">; Upper: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                                    <span class="n">upper</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">maximum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
      <span class="n">maxIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
      <span class="n">minimum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
      <span class="n">minIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmin</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Maximum: </span><span class="si">{:e}</span><span class="s1"> at </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maximum</span><span class="p">,</span>
                                                  <span class="nb">str</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]))</span>
      <span class="k">if</span> <span class="n">numComps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39; component </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Minimum: </span><span class="si">{:e}</span><span class="s1"> at </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span>
                                                       <span class="nb">str</span><span class="p">(</span><span class="n">minIdx</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]))</span>
      <span class="k">if</span> <span class="n">numComps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39; component </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minIdx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">├─ DG info:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Polynomial Order: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]:</span>
          <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Basis Type: </span><span class="si">{:s}</span><span class="s1"> (modal)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Basis Type: </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">])</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">├─ Created with Gkeyll:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Changeset: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">])</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Build Date: </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>

      <span class="c1">#output += &#39;\n- Contains attributes:\n  &#39;</span>
      <span class="c1">#for k in self.attrsList:</span>
      <span class="c1">#    output += &#39;{:s} &#39;.format(k)</span>
      <span class="c1">#end</span>
            
      <span class="k">return</span> <span class="n">output</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="s1">&#39;No data&#39;</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>


  <span class="c1">#-----------------------------------------------------------------</span>
  <span class="c1">#-- Write --------------------------------------------------------</span>
  <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">outName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes data in ADIOS .bp file, ASCII .txt file, or NumPy .npy file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create output file name</span>
    <span class="k">if</span> <span class="n">outName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span>
        <span class="n">outName</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_mod.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">outName</span> <span class="o">=</span> <span class="s1">&#39;gdata.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="c1">#end</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">outName</span><span class="se">\&#39;</span><span class="s1"> must be a string&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mode</span><span class="p">:</span>
        <span class="n">outName</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="n">num_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">()</span>
    <span class="n">numComps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumComps</span><span class="p">()</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span>
      <span class="c1"># Create string number of cells and offsets</span>
      <span class="n">sNumCells</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="n">sOffsets</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">sNumCells</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">,&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numCells</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">sOffsets</span> <span class="o">+=</span> <span class="s1">&#39;0,&#39;</span>
      <span class="c1">#end</span>
      <span class="n">sNumCells</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numComps</span><span class="p">)</span>
      <span class="n">sOffsets</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>

      <span class="c1"># ADIOS init</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">init_noxml</span><span class="p">()</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">set_max_buffer_size</span><span class="p">(</span><span class="n">bufferSize</span><span class="p">)</span>
      <span class="n">groupId</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">declare_group</span><span class="p">(</span><span class="s1">&#39;CartField&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">select_method</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;POSIX1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

      <span class="c1"># Define variables and attributes</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;numCells&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">numCells</span><span class="p">)</span>
      <span class="n">lo</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBounds</span><span class="p">()</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;lowerBounds&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;upperBounds&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">up</span><span class="p">)</span>
      <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;CartField&#39;</span><span class="p">,</span> <span class="n">outName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]:</span>
        <span class="n">adios</span><span class="o">.</span><span class="n">define_var</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                         <span class="n">adios</span><span class="o">.</span><span class="n">DATATYPE</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">adios</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
            
      <span class="n">adios</span><span class="o">.</span><span class="n">define_var</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                       <span class="n">adios</span><span class="o">.</span><span class="n">DATATYPE</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
                       <span class="n">sNumCells</span><span class="p">,</span> <span class="n">sNumCells</span><span class="p">,</span> <span class="n">sOffsets</span><span class="p">)</span>

      <span class="n">adios</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">())</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

      <span class="c1"># Cheating</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nm</span> <span class="o">=</span> <span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">nm</span> <span class="o">=</span> <span class="n">outName</span>
      <span class="c1">#end</span>
      <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">outName</span> <span class="o">+</span> <span class="s1">&#39;.dir/&#39;</span> <span class="o">+</span> <span class="n">nm</span> <span class="o">+</span> <span class="s1">&#39;.0&#39;</span><span class="p">,</span> <span class="n">outName</span><span class="p">)</span>
      <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">outName</span> <span class="o">+</span> <span class="s1">&#39;.dir&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;txt&#39;</span><span class="p">:</span>
      <span class="n">numRows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numCells</span><span class="o">.</span><span class="n">prod</span><span class="p">())</span>
      <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGrid</span><span class="p">()</span>
      <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>

      <span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">numCells</span><span class="p">[(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
      <span class="c1">#end</span>

      <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
          <span class="n">idxs</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span> <span class="o">//</span> <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
          <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="n">idxs</span><span class="p">[</span><span class="n">d</span><span class="p">]])</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">idxs</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numComps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="p">)][</span><span class="n">c</span><span class="p">])</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="p">)][</span><span class="n">numComps</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;npy&#39;</span><span class="p">:</span>
      <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
      <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="c1">#end</span>
  <span class="c1">#end</span>
</pre></div>

        </details>

            <div class="docstring"><p>Provides interface to Gkeyll output data.</p>

<p>Data serves as a baseline interface to Gkeyll data. It is used for
loading Gkeyll data and serves is input to many Postgkyl
functions. Represents a dataset in the Postgkyl command line mode.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>meta:</strong>  A dictionary contaioning a physics information like charge
and/or representation information like polynomial order.</li>
<li><strong>file_name:</strong>  The name of the Gkeyll file used during initialization.</li>
</ul>

<h6 id="examples">Examples</h6>

<blockquote>
  <p>import postgkyl
  data = <a href="../../postgkyl.html#Data">postgkyl.Data</a>('file.bp', comp=1)</p>
</blockquote>
</div>


                            <div id="Data.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Data</span><span class="signature">(
    file_name: str = None,
    comp: Union[int, str] = None,
    z0: Union[int, str] = None,
    z1: Union[int, str] = None,
    z2: Union[int, str] = None,
    z3: Union[int, str] = None,
    z4: Union[int, str] = None,
    z5: Union[int, str] = None,
    var_name: str = &#39;CartGridField&#39;,
    tag: str = &#39;default&#39;,
    label: str = None,
    meta: dict = None,
    comp_grid: bool = False,
    mapc2p_name: str = None
)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">comp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z0</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z1</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z2</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z3</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z4</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z5</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;CartGridField&#39;</span><span class="p">,</span>
               <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
               <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">meta</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">comp_grid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">mapc2p_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initializes the Data class with a Gkeyll output file.</span>

<span class="sd">    Args:</span>
<span class="sd">      fileName: str</span>
<span class="sd">        The name of Gkeyll output file. Currently supported are &#39;h5&#39;,</span>
<span class="sd">        ADIOS1 &#39;bp&#39;, and binary &#39;gkyl&#39; files. Can be ommited for empty</span>
<span class="sd">        class.</span>
<span class="sd">      comp: int or &#39;int:int&#39;</span>
<span class="sd">        Load only the specified component index or a slice of</span>
<span class="sd">        idices. Supported only for the ADIOS &#39;bp&#39; files.</span>
<span class="sd">      z0 - z5: int or &#39;int:int&#39;</span>
<span class="sd">        Load only the specified  index or a slice of</span>
<span class="sd">        idices in a direction. Supported only for the ADIOS &#39;bp&#39; files.</span>
<span class="sd">      var_name: str</span>
<span class="sd">        Specify custom ADIOS variable name (default is &#39;CartGridField&#39;).</span>
<span class="sd">      tag: str</span>
<span class="sd">        Specify dataset tag for use in the command line mode.</span>
<span class="sd">      label: str</span>
<span class="sd">        Specify dataset label for use in the command line mode.</span>
<span class="sd">      meta: dict</span>
<span class="sd">        Copy content of the specified meta dictionary.</span>
<span class="sd">      comp_grid: bool</span>
<span class="sd">        A flag to ignore grid mapping.</span>
<span class="sd">      mapc2p_name: str</span>
<span class="sd">        The name of the file containg the c2p mapping information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span> <span class="o">=</span> <span class="n">tag</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_comp_grid</span> <span class="o">=</span> <span class="n">comp_grid</span> <span class="c1"># disregard the mapped grid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span> <span class="o">=</span> <span class="s1">&#39;uniform&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_gridFile</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># (N+1)D narray of values</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">meta</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span> <span class="o">=</span> <span class="n">label</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span> <span class="o">=</span> <span class="n">var_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mapc2p_name</span> <span class="o">=</span> <span class="n">mapc2p_name</span>
    <span class="k">if</span> <span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="c1"># Sequence load typically concatenates multiple files</span>
      <span class="c1"># When the sequence is in just a single file, _loadFrame will</span>
      <span class="c1"># fail and _loadSequence is called instead</span>
      <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">):</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">z3</span><span class="p">,</span> <span class="n">z4</span><span class="p">,</span> <span class="n">z5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadFrame</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadSequence</span><span class="p">()</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

        </details>

            <div class="docstring"><p>Initializes the Data class with a Gkeyll output file.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>fileName:</strong>  str
The name of Gkeyll output file. Currently supported are 'h5',
ADIOS1 'bp', and binary 'gkyl' files. Can be ommited for empty
class.</li>
<li><strong>comp:</strong>  int or 'int:int'
Load only the specified component index or a slice of
idices. Supported only for the ADIOS 'bp' files.</li>
<li><strong>z0 - z5:</strong>  int or 'int:int'
Load only the specified  index or a slice of
idices in a direction. Supported only for the ADIOS 'bp' files.</li>
<li><strong>var_name:</strong>  str
Specify custom ADIOS variable name (default is 'CartGridField').</li>
<li><strong>tag:</strong>  str
Specify dataset tag for use in the command line mode.</li>
<li><strong>label:</strong>  str
Specify dataset label for use in the command line mode.</li>
<li><strong>meta:</strong>  dict
Copy content of the specified meta dictionary.</li>
<li><strong>comp_grid:</strong>  bool
A flag to ignore grid mapping.</li>
<li><strong>mapc2p_name:</strong>  str
The name of the file containg the c2p mapping information.</li>
</ul>
</div>


                            </div>
                            <div id="Data.getTag" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getTag">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getTag</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.setLabel" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.setLabel">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">setLabel</span><span class="signature">(self, label)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">setLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">label</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getLabel" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getLabel">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getLabel</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_label</span>
    <span class="c1">#end</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getCustomLabel" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getCustomLabel">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getCustomLabel</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getCustomLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_customLabel</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.activate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.activate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">activate</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.deactivate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.deactivate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">deactivate</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">deactivate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getStatus" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getStatus">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getStatus</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_status</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getInputFile" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getInputFile">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getInputFile</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getInputFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
    <span class="n">inputFile</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s1">&#39;inputfile&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">inputFile</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getNumCells" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getNumCells">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getNumCells</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getNumCells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">cells</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getNumComps" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getNumComps">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getNumComps</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getNumComps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getNumDims" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getNumDims">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getNumDims</span><span class="signature">(self, squeeze=False)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getNumDims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">cells</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">num_dims</span> <span class="o">=</span> <span class="n">num_dims</span> <span class="o">-</span> <span class="mi">1</span>
          <span class="c1">#end</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">num_dims</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#end</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getBounds" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getBounds">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getBounds</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
      <span class="n">lo</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">lo</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">up</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
      <span class="c1">#end</span>
      <span class="k">return</span> <span class="n">lo</span><span class="p">,</span> <span class="n">up</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="c1">#end</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getGrid" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getGrid">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getGrid</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getGridType" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getGridType">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getGridType</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getGridType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.getValues" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.getValues">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">getValues</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">getValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.setGrid" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.setGrid">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">setGrid</span><span class="signature">(self, grid)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">setGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.setValues" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.setValues">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">setValues</span><span class="signature">(self, values)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">setValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.push" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.push">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">push</span><span class="signature">(self, grid, values)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
    <span class="k">return</span> <span class="bp">self</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Data.info" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.info">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">info</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prints Data object information.</span>
<span class="sd">    </span>
<span class="sd">    Prints time (only when available), number of components, dimension</span>
<span class="sd">    spans, extremes for a GData object. Only the top of the stack is</span>
<span class="sd">    printed.</span>
<span class="sd">        </span>
<span class="sd">    Args:</span>
<span class="sd">      none</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">      output (str): A list of strings with the informations</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
    <span class="n">numComps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumComps</span><span class="p">()</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">()</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBounds</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Time: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Frame: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Number of components: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numComps</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Number of dimensions: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_dims</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Grid: (</span><span class="si">{:s}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gridType</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Dim </span><span class="si">{:d}</span><span class="s1">: Num. cells: </span><span class="si">{:d}</span><span class="s1">; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">numCells</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;Lower: </span><span class="si">{:e}</span><span class="s1">; Upper: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                                      <span class="n">upper</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
        <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Dim </span><span class="si">{:d}</span><span class="s1">: Num. cells: </span><span class="si">{:d}</span><span class="s1">; &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">numCells</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;Lower: </span><span class="si">{:e}</span><span class="s1">; Upper: </span><span class="si">{:e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                                    <span class="n">upper</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">maximum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
      <span class="n">maxIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
      <span class="n">minimum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
      <span class="n">minIdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmin</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Maximum: </span><span class="si">{:e}</span><span class="s1"> at </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maximum</span><span class="p">,</span>
                                                  <span class="nb">str</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]))</span>
      <span class="k">if</span> <span class="n">numComps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39; component </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maxIdx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="c1">#end</span>
      <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;├─ Minimum: </span><span class="si">{:e}</span><span class="s1"> at </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minimum</span><span class="p">,</span>
                                                       <span class="nb">str</span><span class="p">(</span><span class="n">minIdx</span><span class="p">[:</span><span class="n">num_dims</span><span class="p">]))</span>
      <span class="k">if</span> <span class="n">numComps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39; component </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minIdx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">├─ DG info:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Polynomial Order: </span><span class="si">{:d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;polyOrder&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;isModal&#39;</span><span class="p">]:</span>
          <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Basis Type: </span><span class="si">{:s}</span><span class="s1"> (modal)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Basis Type: </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;basisType&#39;</span><span class="p">])</span>
        <span class="c1">#end</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">]:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">├─ Created with Gkeyll:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  ├─ Changeset: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;changeset&#39;</span><span class="p">])</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s1">&#39;│  └─ Build Date: </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;builddate&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>

      <span class="c1">#output += &#39;\n- Contains attributes:\n  &#39;</span>
      <span class="c1">#for k in self.attrsList:</span>
      <span class="c1">#    output += &#39;{:s} &#39;.format(k)</span>
      <span class="c1">#end</span>
            
      <span class="k">return</span> <span class="n">output</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="s1">&#39;No data&#39;</span>
    <span class="c1">#end</span>
</pre></div>

        </details>

            <div class="docstring"><p>Prints Data object information.</p>

<p>Prints time (only when available), number of components, dimension
spans, extremes for a GData object. Only the top of the stack is
printed.</p>

<h6 id="args">Args</h6>

<ul>
<li>none</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>output (str): A list of strings with the informations</p>
</blockquote>
</div>


                            </div>
                            <div id="Data.write" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Data.write">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">write</span><span class="signature">(self, bufferSize=1000, outName=None, mode=&#39;bp&#39;)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>  <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">outName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes data in ADIOS .bp file, ASCII .txt file, or NumPy .npy file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create output file name</span>
    <span class="k">if</span> <span class="n">outName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span>
        <span class="n">outName</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_mod.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">outName</span> <span class="o">=</span> <span class="s1">&#39;gdata.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="c1">#end</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">outName</span><span class="se">\&#39;</span><span class="s1"> must be a string&#39;</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="k">if</span> <span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mode</span><span class="p">:</span>
        <span class="n">outName</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">mode</span>
      <span class="c1">#end</span>
    <span class="c1">#end</span>

    <span class="n">num_dims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumDims</span><span class="p">()</span>
    <span class="n">numComps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumComps</span><span class="p">()</span>
    <span class="n">numCells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumCells</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;bp&#39;</span><span class="p">:</span>
      <span class="c1"># Create string number of cells and offsets</span>
      <span class="n">sNumCells</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="n">sOffsets</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
        <span class="n">sNumCells</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">,&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numCells</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">sOffsets</span> <span class="o">+=</span> <span class="s1">&#39;0,&#39;</span>
      <span class="c1">#end</span>
      <span class="n">sNumCells</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numComps</span><span class="p">)</span>
      <span class="n">sOffsets</span> <span class="o">+=</span> <span class="s1">&#39;0&#39;</span>

      <span class="c1"># ADIOS init</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">init_noxml</span><span class="p">()</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">set_max_buffer_size</span><span class="p">(</span><span class="n">bufferSize</span><span class="p">)</span>
      <span class="n">groupId</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">declare_group</span><span class="p">(</span><span class="s1">&#39;CartField&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">select_method</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;POSIX1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

      <span class="c1"># Define variables and attributes</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;numCells&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">numCells</span><span class="p">)</span>
      <span class="n">lo</span><span class="p">,</span> <span class="n">up</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBounds</span><span class="p">()</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;lowerBounds&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lo</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">define_attribute_byvalue</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;upperBounds&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">up</span><span class="p">)</span>
      <span class="n">fh</span> <span class="o">=</span> <span class="n">adios</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;CartField&#39;</span><span class="p">,</span> <span class="n">outName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]:</span>
        <span class="n">adios</span><span class="o">.</span><span class="n">define_var</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                         <span class="n">adios</span><span class="o">.</span><span class="n">DATATYPE</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">adios</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
      <span class="c1">#end</span>
            
      <span class="n">adios</span><span class="o">.</span><span class="n">define_var</span><span class="p">(</span><span class="n">groupId</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                       <span class="n">adios</span><span class="o">.</span><span class="n">DATATYPE</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
                       <span class="n">sNumCells</span><span class="p">,</span> <span class="n">sNumCells</span><span class="p">,</span> <span class="n">sOffsets</span><span class="p">)</span>

      <span class="n">adios</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">())</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
      <span class="n">adios</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

      <span class="c1"># Cheating</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nm</span> <span class="o">=</span> <span class="n">outName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">nm</span> <span class="o">=</span> <span class="n">outName</span>
      <span class="c1">#end</span>
      <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">outName</span> <span class="o">+</span> <span class="s1">&#39;.dir/&#39;</span> <span class="o">+</span> <span class="n">nm</span> <span class="o">+</span> <span class="s1">&#39;.0&#39;</span><span class="p">,</span> <span class="n">outName</span><span class="p">)</span>
      <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">outName</span> <span class="o">+</span> <span class="s1">&#39;.dir&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;txt&#39;</span><span class="p">:</span>
      <span class="n">numRows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numCells</span><span class="o">.</span><span class="n">prod</span><span class="p">())</span>
      <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGrid</span><span class="p">()</span>
      <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>

      <span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">numCells</span><span class="p">[(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
      <span class="c1">#end</span>

      <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_dims</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="p">):</span>
          <span class="n">idxs</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span> <span class="o">//</span> <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
          <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">basis</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="n">idxs</span><span class="p">[</span><span class="n">d</span><span class="p">]])</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">idxs</span><span class="p">[</span><span class="n">num_dims</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numComps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="s1">, &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="p">)][</span><span class="n">c</span><span class="p">])</span>
        <span class="c1">#end</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:.15e}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idxs</span><span class="p">)][</span><span class="n">numComps</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
      <span class="c1">#end</span>
      <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;npy&#39;</span><span class="p">:</span>
      <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValues</span><span class="p">()</span>
      <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">outName</span><span class="p">,</span> <span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="c1">#end</span>
</pre></div>

        </details>

            <div class="docstring"><p>Writes data in ADIOS .bp file, ASCII .txt file, or NumPy .npy file</p>
</div>


                            </div>
                </section>
    </main>
<script>/** elasticlunr - http://weixsong.github.io * Copyright (C) 2017 Oliver Nightingale * Copyright (C) 2017 Wei Song * MIT Licensed */!function(){function e(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var t=function(e){var n=new t.Index;return n.pipeline.add(t.trimmer,t.stopWordFilter,t.stemmer),e&&e.call(n,n),n};t.version="0.9.5",lunr=t,t.utils={},t.utils.warn=function(e){return function(t){e.console&&console.warn&&console.warn(t)}}(this),t.utils.toString=function(e){return void 0===e||null===e?"":e.toString()},t.EventEmitter=function(){this.events={}},t.EventEmitter.prototype.addListener=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),n=e;if("function"!=typeof t)throw new TypeError("last argument must be a function");n.forEach(function(e){this.hasHandler(e)||(this.events[e]=[]),this.events[e].push(t)},this)},t.EventEmitter.prototype.removeListener=function(e,t){if(this.hasHandler(e)){var n=this.events[e].indexOf(t);-1!==n&&(this.events[e].splice(n,1),0==this.events[e].length&&delete this.events[e])}},t.EventEmitter.prototype.emit=function(e){if(this.hasHandler(e)){var t=Array.prototype.slice.call(arguments,1);this.events[e].forEach(function(e){e.apply(void 0,t)},this)}},t.EventEmitter.prototype.hasHandler=function(e){return e in this.events},t.tokenizer=function(e){if(!arguments.length||null===e||void 0===e)return[];if(Array.isArray(e)){var n=e.filter(function(e){return null===e||void 0===e?!1:!0});n=n.map(function(e){return t.utils.toString(e).toLowerCase()});var i=[];return n.forEach(function(e){var n=e.split(t.tokenizer.seperator);i=i.concat(n)},this),i}return e.toString().trim().toLowerCase().split(t.tokenizer.seperator)},t.tokenizer.defaultSeperator=/[\s\-]+/,t.tokenizer.seperator=t.tokenizer.defaultSeperator,t.tokenizer.setSeperator=function(e){null!==e&&void 0!==e&&"object"==typeof e&&(t.tokenizer.seperator=e)},t.tokenizer.resetSeperator=function(){t.tokenizer.seperator=t.tokenizer.defaultSeperator},t.tokenizer.getSeperator=function(){return t.tokenizer.seperator},t.Pipeline=function(){this._queue=[]},t.Pipeline.registeredFunctions={},t.Pipeline.registerFunction=function(e,n){n in t.Pipeline.registeredFunctions&&t.utils.warn("Overwriting existing registered function: "+n),e.label=n,t.Pipeline.registeredFunctions[n]=e},t.Pipeline.getRegisteredFunction=function(e){return e in t.Pipeline.registeredFunctions!=!0?null:t.Pipeline.registeredFunctions[e]},t.Pipeline.warnIfFunctionNotRegistered=function(e){var n=e.label&&e.label in this.registeredFunctions;n||t.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",e)},t.Pipeline.load=function(e){var n=new t.Pipeline;return e.forEach(function(e){var i=t.Pipeline.getRegisteredFunction(e);if(!i)throw new Error("Cannot load un-registered function: "+e);n.add(i)}),n},t.Pipeline.prototype.add=function(){var e=Array.prototype.slice.call(arguments);e.forEach(function(e){t.Pipeline.warnIfFunctionNotRegistered(e),this._queue.push(e)},this)},t.Pipeline.prototype.after=function(e,n){t.Pipeline.warnIfFunctionNotRegistered(n);var i=this._queue.indexOf(e);if(-1===i)throw new Error("Cannot find existingFn");this._queue.splice(i+1,0,n)},t.Pipeline.prototype.before=function(e,n){t.Pipeline.warnIfFunctionNotRegistered(n);var i=this._queue.indexOf(e);if(-1===i)throw new Error("Cannot find existingFn");this._queue.splice(i,0,n)},t.Pipeline.prototype.remove=function(e){var t=this._queue.indexOf(e);-1!==t&&this._queue.splice(t,1)},t.Pipeline.prototype.run=function(e){for(var t=[],n=e.length,i=this._queue.length,o=0;n>o;o++){for(var r=e[o],s=0;i>s&&(r=this._queue[s](r,o,e),void 0!==r&&null!==r);s++);void 0!==r&&null!==r&&t.push(r)}return t},t.Pipeline.prototype.reset=function(){this._queue=[]},t.Pipeline.prototype.get=function(){return this._queue},t.Pipeline.prototype.toJSON=function(){return this._queue.map(function(e){return t.Pipeline.warnIfFunctionNotRegistered(e),e.label})},t.Index=function(){this._fields=[],this._ref="id",this.pipeline=new t.Pipeline,this.documentStore=new t.DocumentStore,this.index={},this.eventEmitter=new t.EventEmitter,this._idfCache={},this.on("add","remove","update",function(){this._idfCache={}}.bind(this))},t.Index.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,e)},t.Index.prototype.off=function(e,t){return this.eventEmitter.removeListener(e,t)},t.Index.load=function(e){e.version!==t.version&&t.utils.warn("version mismatch: current "+t.version+" importing "+e.version);var n=new this;n._fields=e.fields,n._ref=e.ref,n.documentStore=t.DocumentStore.load(e.documentStore),n.pipeline=t.Pipeline.load(e.pipeline),n.index={};for(var i in e.index)n.index[i]=t.InvertedIndex.load(e.index[i]);return n},t.Index.prototype.addField=function(e){return this._fields.push(e),this.index[e]=new t.InvertedIndex,this},t.Index.prototype.setRef=function(e){return this._ref=e,this},t.Index.prototype.saveDocument=function(e){return this.documentStore=new t.DocumentStore(e),this},t.Index.prototype.addDoc=function(e,n){if(e){var n=void 0===n?!0:n,i=e[this._ref];this.documentStore.addDoc(i,e),this._fields.forEach(function(n){var o=this.pipeline.run(t.tokenizer(e[n]));this.documentStore.addFieldLength(i,n,o.length);var r={};o.forEach(function(e){e in r?r[e]+=1:r[e]=1},this);for(var s in r){var u=r[s];u=Math.sqrt(u),this.index[n].addToken(s,{ref:i,tf:u})}},this),n&&this.eventEmitter.emit("add",e,this)}},t.Index.prototype.removeDocByRef=function(e){if(e&&this.documentStore.isDocStored()!==!1&&this.documentStore.hasDoc(e)){var t=this.documentStore.getDoc(e);this.removeDoc(t,!1)}},t.Index.prototype.removeDoc=function(e,n){if(e){var n=void 0===n?!0:n,i=e[this._ref];this.documentStore.hasDoc(i)&&(this.documentStore.removeDoc(i),this._fields.forEach(function(n){var o=this.pipeline.run(t.tokenizer(e[n]));o.forEach(function(e){this.index[n].removeToken(e,i)},this)},this),n&&this.eventEmitter.emit("remove",e,this))}},t.Index.prototype.updateDoc=function(e,t){var t=void 0===t?!0:t;this.removeDocByRef(e[this._ref],!1),this.addDoc(e,!1),t&&this.eventEmitter.emit("update",e,this)},t.Index.prototype.idf=function(e,t){var n="@"+t+"/"+e;if(Object.prototype.hasOwnProperty.call(this._idfCache,n))return this._idfCache[n];var i=this.index[t].getDocFreq(e),o=1+Math.log(this.documentStore.length/(i+1));return this._idfCache[n]=o,o},t.Index.prototype.getFields=function(){return this._fields.slice()},t.Index.prototype.search=function(e,n){if(!e)return[];e="string"==typeof e?{any:e}:JSON.parse(JSON.stringify(e));var i=null;null!=n&&(i=JSON.stringify(n));for(var o=new t.Configuration(i,this.getFields()).get(),r={},s=Object.keys(e),u=0;u<s.length;u++){var a=s[u];r[a]=this.pipeline.run(t.tokenizer(e[a]))}var l={};for(var c in o){var d=r[c]||r.any;if(d){var f=this.fieldSearch(d,c,o),h=o[c].boost;for(var p in f)f[p]=f[p]*h;for(var p in f)p in l?l[p]+=f[p]:l[p]=f[p]}}var v,g=[];for(var p in l)v={ref:p,score:l[p]},this.documentStore.hasDoc(p)&&(v.doc=this.documentStore.getDoc(p)),g.push(v);return g.sort(function(e,t){return t.score-e.score}),g},t.Index.prototype.fieldSearch=function(e,t,n){var i=n[t].bool,o=n[t].expand,r=n[t].boost,s=null,u={};return 0!==r?(e.forEach(function(e){var n=[e];1==o&&(n=this.index[t].expandToken(e));var r={};n.forEach(function(n){var o=this.index[t].getDocs(n),a=this.idf(n,t);if(s&&"AND"==i){var l={};for(var c in s)c in o&&(l[c]=o[c]);o=l}n==e&&this.fieldSearchStats(u,n,o);for(var c in o){var d=this.index[t].getTermFrequency(n,c),f=this.documentStore.getFieldLength(c,t),h=1;0!=f&&(h=1/Math.sqrt(f));var p=1;n!=e&&(p=.15*(1-(n.length-e.length)/n.length));var v=d*a*h*p;c in r?r[c]+=v:r[c]=v}},this),s=this.mergeScores(s,r,i)},this),s=this.coordNorm(s,u,e.length)):void 0},t.Index.prototype.mergeScores=function(e,t,n){if(!e)return t;if("AND"==n){var i={};for(var o in t)o in e&&(i[o]=e[o]+t[o]);return i}for(var o in t)o in e?e[o]+=t[o]:e[o]=t[o];return e},t.Index.prototype.fieldSearchStats=function(e,t,n){for(var i in n)i in e?e[i].push(t):e[i]=[t]},t.Index.prototype.coordNorm=function(e,t,n){for(var i in e)if(i in t){var o=t[i].length;e[i]=e[i]*o/n}return e},t.Index.prototype.toJSON=function(){var e={};return this._fields.forEach(function(t){e[t]=this.index[t].toJSON()},this),{version:t.version,fields:this._fields,ref:this._ref,documentStore:this.documentStore.toJSON(),index:e,pipeline:this.pipeline.toJSON()}},t.Index.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this),e.apply(this,t)},t.DocumentStore=function(e){this._save=null===e||void 0===e?!0:e,this.docs={},this.docInfo={},this.length=0},t.DocumentStore.load=function(e){var t=new this;return t.length=e.length,t.docs=e.docs,t.docInfo=e.docInfo,t._save=e.save,t},t.DocumentStore.prototype.isDocStored=function(){return this._save},t.DocumentStore.prototype.addDoc=function(t,n){this.hasDoc(t)||this.length++,this.docs[t]=this._save===!0?e(n):null},t.DocumentStore.prototype.getDoc=function(e){return this.hasDoc(e)===!1?null:this.docs[e]},t.DocumentStore.prototype.hasDoc=function(e){return e in this.docs},t.DocumentStore.prototype.removeDoc=function(e){this.hasDoc(e)&&(delete this.docs[e],delete this.docInfo[e],this.length--)},t.DocumentStore.prototype.addFieldLength=function(e,t,n){null!==e&&void 0!==e&&0!=this.hasDoc(e)&&(this.docInfo[e]||(this.docInfo[e]={}),this.docInfo[e][t]=n)},t.DocumentStore.prototype.updateFieldLength=function(e,t,n){null!==e&&void 0!==e&&0!=this.hasDoc(e)&&this.addFieldLength(e,t,n)},t.DocumentStore.prototype.getFieldLength=function(e,t){return null===e||void 0===e?0:e in this.docs&&t in this.docInfo[e]?this.docInfo[e][t]:0},t.DocumentStore.prototype.toJSON=function(){return{docs:this.docs,docInfo:this.docInfo,length:this.length,save:this._save}},t.stemmer=function(){var e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},t={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[^aeiou]",i="[aeiouy]",o=n+"[^aeiouy]*",r=i+"[aeiou]*",s="^("+o+")?"+r+o,u="^("+o+")?"+r+o+"("+r+")?$",a="^("+o+")?"+r+o+r+o,l="^("+o+")?"+i,c=new RegExp(s),d=new RegExp(a),f=new RegExp(u),h=new RegExp(l),p=/^(.+?)(ss|i)es$/,v=/^(.+?)([^s])s$/,g=/^(.+?)eed$/,m=/^(.+?)(ed|ing)$/,y=/.$/,S=/(at|bl|iz)$/,x=new RegExp("([^aeiouylsz])\\1$"),w=new RegExp("^"+o+i+"[^aeiouwxy]$"),I=/^(.+?[^aeiou])y$/,b=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,E=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,D=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,F=/^(.+?)(s|t)(ion)$/,_=/^(.+?)e$/,P=/ll$/,k=new RegExp("^"+o+i+"[^aeiouwxy]$"),z=function(n){var i,o,r,s,u,a,l;if(n.length<3)return n;if(r=n.substr(0,1),"y"==r&&(n=r.toUpperCase()+n.substr(1)),s=p,u=v,s.test(n)?n=n.replace(s,"$1$2"):u.test(n)&&(n=n.replace(u,"$1$2")),s=g,u=m,s.test(n)){var z=s.exec(n);s=c,s.test(z[1])&&(s=y,n=n.replace(s,""))}else if(u.test(n)){var z=u.exec(n);i=z[1],u=h,u.test(i)&&(n=i,u=S,a=x,l=w,u.test(n)?n+="e":a.test(n)?(s=y,n=n.replace(s,"")):l.test(n)&&(n+="e"))}if(s=I,s.test(n)){var z=s.exec(n);i=z[1],n=i+"i"}if(s=b,s.test(n)){var z=s.exec(n);i=z[1],o=z[2],s=c,s.test(i)&&(n=i+e[o])}if(s=E,s.test(n)){var z=s.exec(n);i=z[1],o=z[2],s=c,s.test(i)&&(n=i+t[o])}if(s=D,u=F,s.test(n)){var z=s.exec(n);i=z[1],s=d,s.test(i)&&(n=i)}else if(u.test(n)){var z=u.exec(n);i=z[1]+z[2],u=d,u.test(i)&&(n=i)}if(s=_,s.test(n)){var z=s.exec(n);i=z[1],s=d,u=f,a=k,(s.test(i)||u.test(i)&&!a.test(i))&&(n=i)}return s=P,u=d,s.test(n)&&u.test(n)&&(s=y,n=n.replace(s,"")),"y"==r&&(n=r.toLowerCase()+n.substr(1)),n};return z}(),t.Pipeline.registerFunction(t.stemmer,"stemmer"),t.stopWordFilter=function(e){return e&&t.stopWordFilter.stopWords[e]!==!0?e:void 0},t.clearStopWords=function(){t.stopWordFilter.stopWords={}},t.addStopWords=function(e){null!=e&&Array.isArray(e)!==!1&&e.forEach(function(e){t.stopWordFilter.stopWords[e]=!0},this)},t.resetStopWords=function(){t.stopWordFilter.stopWords=t.defaultStopWords},t.defaultStopWords={"":!0,a:!0,able:!0,about:!0,across:!0,after:!0,all:!0,almost:!0,also:!0,am:!0,among:!0,an:!0,and:!0,any:!0,are:!0,as:!0,at:!0,be:!0,because:!0,been:!0,but:!0,by:!0,can:!0,cannot:!0,could:!0,dear:!0,did:!0,"do":!0,does:!0,either:!0,"else":!0,ever:!0,every:!0,"for":!0,from:!0,get:!0,got:!0,had:!0,has:!0,have:!0,he:!0,her:!0,hers:!0,him:!0,his:!0,how:!0,however:!0,i:!0,"if":!0,"in":!0,into:!0,is:!0,it:!0,its:!0,just:!0,least:!0,let:!0,like:!0,likely:!0,may:!0,me:!0,might:!0,most:!0,must:!0,my:!0,neither:!0,no:!0,nor:!0,not:!0,of:!0,off:!0,often:!0,on:!0,only:!0,or:!0,other:!0,our:!0,own:!0,rather:!0,said:!0,say:!0,says:!0,she:!0,should:!0,since:!0,so:!0,some:!0,than:!0,that:!0,the:!0,their:!0,them:!0,then:!0,there:!0,these:!0,they:!0,"this":!0,tis:!0,to:!0,too:!0,twas:!0,us:!0,wants:!0,was:!0,we:!0,were:!0,what:!0,when:!0,where:!0,which:!0,"while":!0,who:!0,whom:!0,why:!0,will:!0,"with":!0,would:!0,yet:!0,you:!0,your:!0},t.stopWordFilter.stopWords=t.defaultStopWords,t.Pipeline.registerFunction(t.stopWordFilter,"stopWordFilter"),t.trimmer=function(e){if(null===e||void 0===e)throw new Error("token should not be undefined");return e.replace(/^\W+/,"").replace(/\W+$/,"")},t.Pipeline.registerFunction(t.trimmer,"trimmer"),t.InvertedIndex=function(){this.root={docs:{},df:0}},t.InvertedIndex.load=function(e){var t=new this;return t.root=e.root,t},t.InvertedIndex.prototype.addToken=function(e,t,n){for(var n=n||this.root,i=0;i<=e.length-1;){var o=e[i];o in n||(n[o]={docs:{},df:0}),i+=1,n=n[o]}var r=t.ref;n.docs[r]?n.docs[r]={tf:t.tf}:(n.docs[r]={tf:t.tf},n.df+=1)},t.InvertedIndex.prototype.hasToken=function(e){if(!e)return!1;for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return!1;t=t[e[n]]}return!0},t.InvertedIndex.prototype.getNode=function(e){if(!e)return null;for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return null;t=t[e[n]]}return t},t.InvertedIndex.prototype.getDocs=function(e){var t=this.getNode(e);return null==t?{}:t.docs},t.InvertedIndex.prototype.getTermFrequency=function(e,t){var n=this.getNode(e);return null==n?0:t in n.docs?n.docs[t].tf:0},t.InvertedIndex.prototype.getDocFreq=function(e){var t=this.getNode(e);return null==t?0:t.df},t.InvertedIndex.prototype.removeToken=function(e,t){if(e){var n=this.getNode(e);null!=n&&t in n.docs&&(delete n.docs[t],n.df-=1)}},t.InvertedIndex.prototype.expandToken=function(e,t,n){if(null==e||""==e)return[];var t=t||[];if(void 0==n&&(n=this.getNode(e),null==n))return t;n.df>0&&t.push(e);for(var i in n)"docs"!==i&&"df"!==i&&this.expandToken(e+i,t,n[i]);return t},t.InvertedIndex.prototype.toJSON=function(){return{root:this.root}},t.Configuration=function(e,n){var e=e||"";if(void 0==n||null==n)throw new Error("fields should not be null");this.config={};var i;try{i=JSON.parse(e),this.buildUserConfig(i,n)}catch(o){t.utils.warn("user configuration parse failed, will use default configuration"),this.buildDefaultConfig(n)}},t.Configuration.prototype.buildDefaultConfig=function(e){this.reset(),e.forEach(function(e){this.config[e]={boost:1,bool:"OR",expand:!1}},this)},t.Configuration.prototype.buildUserConfig=function(e,n){var i="OR",o=!1;if(this.reset(),"bool"in e&&(i=e.bool||i),"expand"in e&&(o=e.expand||o),"fields"in e)for(var r in e.fields)if(n.indexOf(r)>-1){var s=e.fields[r],u=o;void 0!=s.expand&&(u=s.expand),this.config[r]={boost:s.boost||0===s.boost?s.boost:1,bool:s.bool||i,expand:u}}else t.utils.warn("field name in user configuration not found in index instance fields");else this.addAllFields2UserConfig(i,o,n)},t.Configuration.prototype.addAllFields2UserConfig=function(e,t,n){n.forEach(function(n){this.config[n]={boost:1,bool:e,expand:t}},this)},t.Configuration.prototype.get=function(){return this.config},t.Configuration.prototype.reset=function(){this.config={}},lunr.SortedSet=function(){this.length=0,this.elements=[]},lunr.SortedSet.load=function(e){var t=new this;return t.elements=e,t.length=e.length,t},lunr.SortedSet.prototype.add=function(){var e,t;for(e=0;e<arguments.length;e++)t=arguments[e],~this.indexOf(t)||this.elements.splice(this.locationFor(t),0,t);this.length=this.elements.length},lunr.SortedSet.prototype.toArray=function(){return this.elements.slice()},lunr.SortedSet.prototype.map=function(e,t){return this.elements.map(e,t)},lunr.SortedSet.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},lunr.SortedSet.prototype.indexOf=function(e){for(var t=0,n=this.elements.length,i=n-t,o=t+Math.floor(i/2),r=this.elements[o];i>1;){if(r===e)return o;e>r&&(t=o),r>e&&(n=o),i=n-t,o=t+Math.floor(i/2),r=this.elements[o]}return r===e?o:-1},lunr.SortedSet.prototype.locationFor=function(e){for(var t=0,n=this.elements.length,i=n-t,o=t+Math.floor(i/2),r=this.elements[o];i>1;)e>r&&(t=o),r>e&&(n=o),i=n-t,o=t+Math.floor(i/2),r=this.elements[o];return r>e?o:e>r?o+1:void 0},lunr.SortedSet.prototype.intersect=function(e){for(var t=new lunr.SortedSet,n=0,i=0,o=this.length,r=e.length,s=this.elements,u=e.elements;;){if(n>o-1||i>r-1)break;s[n]!==u[i]?s[n]<u[i]?n++:s[n]>u[i]&&i++:(t.add(s[n]),n++,i++)}return t},lunr.SortedSet.prototype.clone=function(){var e=new lunr.SortedSet;return e.elements=this.toArray(),e.length=e.elements.length,e},lunr.SortedSet.prototype.union=function(e){var t,n,i;this.length>=e.length?(t=this,n=e):(t=e,n=this),i=t.clone();for(var o=0,r=n.toArray();o<r.length;o++)i.add(r[o]);return i},lunr.SortedSet.prototype.toJSON=function(){return this.toArray()},function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.elasticlunr=t()}(this,function(){return t})}();</script>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let searchIndex, searchErr;

    async function initialize() {
        let docs;
        try {
            let resp = await fetch("../../search.json");
            docs = await resp.json();
        } catch (e) {
            searchErr = "Cannot fetch search index.";
            throw e;
        }

        // Also split on html tags. this is a cheap heuristic, but good enough.
        elasticlunr.tokenizer.setSeperator(/[\s\-.;&]+|<[^>]*>/);

        if (docs._isPrebuiltIndex) {
            console.info("using precompiled search index");
            searchIndex = elasticlunr.Index.load(docs);
        } else {
            console.time("building search index");
            searchIndex = elasticlunr(function () {
                this.addField('qualname');
                this.addField('fullname');
                this.addField('doc');
                this.setRef('fullname');
            });
            for (let doc of docs) {
                searchIndex.addDoc(doc);
            }
            console.timeEnd("building search index");
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const search = getSearchTerm();
            if (!search) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!searchIndex) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = searchIndex.search(search, {
                fields: {
                    qualname: {boost: 4},
                    fullname: {boost: 2},
                    doc: {boost: 1},
                },
                expand: true
            });

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(search)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(search)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">(${doc.parameters.join(", ")})</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script>